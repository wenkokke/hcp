\begin{lemma}\label{lem:cp-progress-link}
  If $\seq[{ \cpPlug{G}{P_1 \dots P_n} }]{ \Gamma }$, and some $\tm{P_i}$ is a
  link \tm{\cpLink{x}{y}}, then either $\tm{x}$ and $\tm{y}$ are not bound by
  $\tm{G}$, or there exist $\tm{E}$, $\tm{E'}$ and $\tm{Q}$ such that
  $\tm{\cpPlug{G}{P_1 \dots P_n}} \equiv
  \tm{\cpPlug{E}{\cpCut{x}{\cpPlug{E'}{\cpLink{x}{y}}}{Q}}}$. 
\end{lemma}
\begin{proof}
  By induction on the structure of $\tm{G}$.
  \begin{itemize}
  \item
    Case $\tm{\hole}$. Clearly $\tm{x}$ and $\tm{y}$ are not bound.
  \item
    Case $\tm{\cpCut{z}{\cpPlug{G'}{P_1 \dots P_i \dots P_m}}{\cpPlug{G''}{P_{m+1} \dots P_n}}}$.\\
    Case $\tm{\cpCut{z}{\cpPlug{G'}{P_1 \dots P_m}}{\cpPlug{G''}{P_{m+1} \dots P_i \dots P_n}}}$.\\
    We apply the induction hypothesis. There are two cases:
    \begin{itemize}
    \item
      If $\tm{x}$ and $\tm{y}$ were not bound, they remain unbound.
    \item
      If $\tm{x}$ or $\tm{y}$ is bound deeper in $\tm{G}$, we prepend one of
      $\tm{\cpCut{z}{\hole}{\cpPlug{G''}{P_{m+1} \dots P_n}}}$,
      $\tm{\cpCut{z}{\cpPlug{G'}{P_1 \dots P_m}}{\hole}}$,
      $\tm{\piPar{\hole}{\cpPlug{G''}{P_{m+1} \dots P_n}}}$, or
      $\tm{\piPar{\cpPlug{G'}{P_1 \dots P_m}}{\hole}}$ to $\tm{E}$.
      The desired equivalence follows by congruence.
    \end{itemize}
  \item
    Case $\tm{\cpCut{x}{\cpPlug{G'}{P_1 \dots P_i \dots P_m}}{\cpPlug{G''}{P_{m+1} \dots P_n}}}$.\\
    Case $\tm{\cpCut{y}{\cpPlug{G'}{P_1 \dots P_i \dots P_m}}{\cpPlug{G''}{P_{m+1} \dots P_n}}}$.\\
    Case $\tm{\cpCut{x}{\cpPlug{G'}{P_1 \dots P_m}}{\cpPlug{G''}{P_{m+1} \dots P_i \dots P_n}}}$.\\
    Case $\tm{\cpCut{y}{\cpPlug{G'}{P_1 \dots P_m}}{\cpPlug{G''}{P_{m+1} \dots P_i \dots P_n}}}$.
    \\
    \(
    \arraycolsep=4pt
    \begin{array}[t]{llrl}
      \text{Let} & \tm{E}  & :=       & \tm{\hole} \\
                 & \tm{E'} & :=       & \tm{\cpPlug{G'}{P_1 \dots P_{i-1}, \hole, P_{i+1}, \dots P_m}} \\
                 &         &\text{or} & \tm{\cpPlug{G''}{P_{m+1} \dots P_{i-1}, \hole, P_{i+1}, \dots P_n}}
    \end{array}
    \)
    \\[1ex]
    By reflexivity and \cpEquivCutComm.
  \end{itemize}
\end{proof}
%%% Local Variables:
%%% TeX-master: "main"
%%% End:
